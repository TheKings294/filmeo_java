<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{base :: layout(~{::body})}">
<head>
    <title>User form</title>
</head>

<body class="min-h-screen bg-black">

<!-- HEADER -->
<div class="border-b border-neutral-800 bg-neutral-950">
    <div class="max-w-4xl mx-auto px-4 md:px-8 py-6">
        <h1 class="text-2xl font-bold text-white"
            th:text="${editMode} ? 'Edit User' : 'Create User'"></h1>
        <p class="text-neutral-400 text-sm">
            Manage user account information
        </p>
    </div>
</div>

<!-- FORM -->
<div class="max-w-4xl mx-auto px-4 md:px-8 py-8">
    <form th:action="@{${basePath}(id=${userId})}"
          th:width="basePath=${editMode ? '/admin/users/update' + userId : '/admin/users/new'}"
          th:object="${userForm}"
          method="post"
          class="space-y-8">

        <!-- GLOBAL ERRORS -->
        <div th:if="${#fields.hasErrors()}"
             class="bg-red-900/40 border border-red-600 text-red-300 rounded-lg p-4">
            <p class="font-semibold mb-2">Please fix the following errors:</p>
            <ul class="list-disc list-inside text-sm">
                <li th:each="err : ${#fields.errors('*')}"
                    th:text="${err}"></li>
            </ul>
        </div>

        <!-- ACCOUNT INFO -->
        <div class="bg-neutral-950 rounded-lg border border-neutral-800 p-6">
            <h2 class="text-xl font-semibold text-white mb-6">Account Information</h2>

            <div class="space-y-4">

                <!-- PSEUDO -->
                <div>
                    <label class="block text-sm text-neutral-300 mb-2">Pseudo *</label>
                    <input type="text"
                           th:field="*{pseudo}"
                           class="w-full bg-neutral-900 text-white px-4 py-3 rounded-lg border border-neutral-800"
                           th:classappend="${#fields.hasErrors('pseudo')} ? 'border-red-600' : ''">
                    <p th:errors="*{pseudo}" class="text-red-500 text-sm mt-1"></p>
                </div>

                <!-- EMAIL -->
                <div>
                    <label class="block text-sm text-neutral-300 mb-2">Email *</label>
                    <input type="email"
                           th:field="*{email}"
                           class="w-full bg-neutral-900 text-white px-4 py-3 rounded-lg border border-neutral-800"
                           th:classappend="${#fields.hasErrors('email')} ? 'border-red-600' : ''">
                    <p th:errors="*{email}" class="text-red-500 text-sm mt-1"></p>
                </div>

            </div>
        </div>

        <!-- PASSWORD (CREATE MODE ONLY) -->
        <div th:if="${!editMode}"
             class="bg-neutral-950 rounded-lg border border-neutral-800 p-6">
            <h2 class="text-xl font-semibold text-white mb-6">Security</h2>

            <div class="space-y-4">

                <!-- PASSWORD -->
                <div>
                    <label class="block text-sm text-neutral-300 mb-2">Password *</label>
                    <input type="password"
                           th:field="*{password}"
                           class="w-full bg-neutral-900 text-white px-4 py-3 rounded-lg border border-neutral-800"
                           th:classappend="${#fields.hasErrors('password')} ? 'border-red-600' : ''">
                    <p th:errors="*{password}" class="text-red-500 text-sm mt-1"></p>
                </div>

                <!-- CONFIRM PASSWORD -->
                <div>
                    <label class="block text-sm text-neutral-300 mb-2">Confirm Password *</label>
                    <input type="password"
                           th:field="*{confirmPassword}"
                           class="w-full bg-neutral-900 text-white px-4 py-3 rounded-lg border border-neutral-800"
                           th:classappend="${#fields.hasErrors('confirmPassword')} ? 'border-red-600' : ''">
                    <p th:errors="*{confirmPassword}" class="text-red-500 text-sm mt-1"></p>
                </div>

            </div>
        </div>

        <!-- EDIT MODE INFO -->
        <div th:if="${editMode}"
             class="bg-neutral-900 border border-neutral-800 text-neutral-300 rounded-lg p-4 text-sm">
            Password cannot be changed here.
            <span class="text-neutral-400">
            Use the dedicated password reset feature if needed.
        </span>
        </div>

        <!-- ACTIONS -->
        <div class="flex gap-4">
            <button type="submit"
                    class="flex-1 bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold">
                Save User
            </button>

            <a th:href="@{/admin/users}"
               class="px-6 py-3 bg-neutral-800 hover:bg-neutral-700 text-white rounded-lg">
                Cancel
            </a>
        </div>

    </form>
</div>

</body>
</html>
